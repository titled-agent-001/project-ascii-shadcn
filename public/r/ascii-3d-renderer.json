{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "ascii-3d-renderer",
  "title": "ASCII 3D Renderer",
  "description": "Renders 3D geometry or GLTF models as live ASCII art using Three.js AsciiEffect. Supports torus knot, sphere, cube, torus, cylinder, and custom model URLs with orbit controls.",
  "dependencies": [
    "three",
    "@types/three"
  ],
  "files": [
    {
      "path": "src/registry/new-york/ascii-3d-renderer/ascii-3d-renderer.tsx",
      "content": "\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport type * as THREE from \"three\";\n\nexport interface Ascii3DRendererProps {\n  width?: number;\n  height?: number;\n  charset?: string;\n  geometry?: \"torusknot\" | \"sphere\" | \"cube\" | \"torus\" | \"cylinder\" | \"horse\";\n  modelUrl?: string;\n  modelScale?: number;\n  color?: string;\n  autoRotate?: boolean;\n  rotationSpeed?: number;\n  enableControls?: boolean;\n  invert?: boolean;\n}\n\nexport function Ascii3DRenderer({\n  width = 500,\n  height = 300,\n  charset = \" .:-+*=%@#\",\n  geometry = \"torusknot\",\n  modelUrl,\n  modelScale,\n  color = \"#ffffff\",\n  autoRotate = true,\n  rotationSpeed = 1,\n  enableControls = true,\n  invert = false,\n}: Ascii3DRendererProps) {\n  const ref = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) return;\n\n    let animId: number | null = null;\n    let renderer: any = null;\n    let themeObserver: MutationObserver | null = null;\n\n    // Dynamic import to avoid SSR issues with Three.js\n    Promise.all([\n      import(\"three\"),\n      import(\"three/examples/jsm/effects/AsciiEffect.js\"),\n      import(\"three/examples/jsm/controls/OrbitControls.js\"),\n      import(\"three/examples/jsm/loaders/GLTFLoader.js\"),\n    ]).then(([THREE, { AsciiEffect }, { OrbitControls }, { GLTFLoader }]) => {\n      if (!el) return;\n\n      const scene = new THREE.Scene();\n      scene.background = new THREE.Color(\"#000000\");\n\n      const camera = new THREE.PerspectiveCamera(70, width / height, 1, 1000);\n      camera.position.z = 5;\n\n      const ambient = new THREE.AmbientLight(0xffffff, 0.5);\n      scene.add(ambient);\n      const point = new THREE.PointLight(0xffffff, 1.5, 100);\n      point.position.set(10, 10, 10);\n      scene.add(point);\n      const dir = new THREE.DirectionalLight(0xffffff, 0.8);\n      dir.position.set(-5, 5, 5);\n      scene.add(dir);\n\n      let mesh: THREE.Object3D | null = null;\n      let mixer: THREE.AnimationMixer | null = null;\n      const clock = new THREE.Clock();\n\n      const gltfUrl = modelUrl ?? (geometry === \"horse\" ? \"/models/Horse.glb\" : null);\n\n      if (gltfUrl) {\n        const loader = new GLTFLoader();\n        loader.load(gltfUrl, (gltf: any) => {\n          const model = gltf.scene;\n          const scale = modelScale ?? (geometry === \"horse\" ? 0.02 : 1);\n          model.scale.set(scale, scale, scale);\n          const box = new THREE.Box3().setFromObject(model);\n          const center = box.getCenter(new THREE.Vector3());\n          model.position.sub(center);\n          model.traverse((child: any) => {\n            if (child.isMesh) {\n              child.material = new THREE.MeshStandardMaterial({ color: new THREE.Color(color) });\n            }\n          });\n          scene.add(model);\n          mesh = model;\n          if (gltf.animations && gltf.animations.length > 0) {\n            mixer = new THREE.AnimationMixer(model);\n            gltf.animations.forEach((clip: THREE.AnimationClip) => {\n              mixer!.clipAction(clip).play();\n            });\n          }\n        });\n      } else {\n        let geo: THREE.BufferGeometry;\n        switch (geometry) {\n          case \"sphere\": geo = new THREE.SphereGeometry(2, 32, 32); break;\n          case \"cube\": geo = new THREE.BoxGeometry(2.5, 2.5, 2.5); break;\n          case \"torus\": geo = new THREE.TorusGeometry(2, 0.6, 16, 100); break;\n          case \"cylinder\": geo = new THREE.CylinderGeometry(1.5, 1.5, 3, 32); break;\n          default: geo = new THREE.TorusKnotGeometry(1.5, 0.5, 128, 16); break;\n        }\n        const mat = new THREE.MeshStandardMaterial({ color: new THREE.Color(color) });\n        mesh = new THREE.Mesh(geo, mat);\n        scene.add(mesh);\n      }\n\n      renderer = new THREE.WebGLRenderer();\n      renderer.setSize(width, height);\n\n      const effect = new AsciiEffect(renderer, charset, { invert });\n      effect.setSize(width, height);\n\n      const computedStyle = getComputedStyle(document.body);\n      effect.domElement.style.color = computedStyle.color;\n      effect.domElement.style.backgroundColor = computedStyle.backgroundColor;\n      effect.domElement.style.fontFamily = \"Menlo, Consolas, 'Courier New', monospace\";\n      effect.domElement.style.fontSize = \"10px\";\n      effect.domElement.style.lineHeight = \"10px\";\n      effect.domElement.style.overflow = \"hidden\";\n      el.appendChild(effect.domElement);\n\n      let controls: any = null;\n      if (enableControls) {\n        controls = new OrbitControls(camera, effect.domElement);\n        controls.enableDamping = true;\n      }\n\n      themeObserver = new MutationObserver(() => {\n        const style = getComputedStyle(document.body);\n        effect.domElement.style.color = style.color;\n        effect.domElement.style.backgroundColor = style.backgroundColor;\n      });\n      themeObserver.observe(document.documentElement, { attributes: true, attributeFilter: [\"class\"] });\n\n      const animate = () => {\n        animId = requestAnimationFrame(animate);\n        const delta = clock.getDelta();\n        if (mixer) mixer.update(delta);\n        if (autoRotate && mesh) mesh.rotation.y += 0.01 * rotationSpeed;\n        controls?.update();\n        effect.render(scene, camera);\n      };\n      animate();\n    });\n\n    return () => {\n      if (animId !== null) cancelAnimationFrame(animId);\n      themeObserver?.disconnect();\n      renderer?.dispose();\n      if (el) el.innerHTML = \"\";\n    };\n  }, [width, height, charset, geometry, modelUrl, modelScale, color, autoRotate, rotationSpeed, enableControls, invert]);\n\n  return <div ref={ref} style={{ width, height, overflow: \"hidden\" }} />;\n}\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:block"
}